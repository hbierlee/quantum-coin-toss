\documentclass[oneside,a4paper]{article}

% ========== Preamble (packages, definitions etc.) ==========

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{amsmath, amsthm, amssymb}
\usepackage{csquotes}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{lmodern}
\usepackage{float}

\setlength{\parskip}{\baselineskip}

%\newcounter{questionnum} \setcounter{questionnum}{0}
%\newcommand{\question}[1]{%
%  \refstepcounter{questionnum}%
%  \paragraph{Question~\arabic{questionnum}:}{\emph{#1}}}

\newcommand\filltoend{\leavevmode{\unskip
  \leaders\hrule height.5ex depth\dimexpr-.5ex+0.4pt\hfill\hbox{}%
  \parfillskip=0pt\endgraf}}

\newcommand{\problem}[2]{%
	\vspace{-0.7em}
	\hspace{0.02\textwidth}
	\begin{minipage}[t][][b]{0.95\textwidth}
		{\bf \hspace{-0.015\textwidth}\makebox[7.5em][l]{{#1} ~~\filltoend}}%
		\hspace{1.2mm}{\it #2}%
	\end{minipage}
}

\lstset{ % Set the default style for code listings
	numbers=left, 
	numberstyle=\scriptsize, 
	numbersep=8pt,
	basicstyle=\scriptsize\ttfamily,
	keywordstyle=\color{blue},
	stringstyle=\color{red},
	commentstyle=\color{green!70!black},
	breaklines=true,
	frame=single, 
	language=C++,
	captionpos=b,
	tabsize=4,
	showstringspaces=false
}


% ========== Title page ==========

\title {
	\includegraphics[width=0.6\textwidth]{UU_logo.pdf}\\[1em]
	Cryptology \\
	Report\\[1em]
	%\\[3em]
	Quantum cryptography: Public key distribution and coin tossing
}

\author{
		Hendrik Bierlee \and
		Nodari Kankava
}

\begin{document}



\maketitle
\thispagestyle{empty} % Removes page number for front page
\pagebreak

\newcounter{qcounter}
\setcounter{qcounter}{1}
\newcommand{\question}[1]{\par\vspace{10px}\noindent\textbf{Question \theqcounter \stepcounter{qcounter}:} \emph{#1}\vspace{0.5em}\\\noindent}


% ========== Document contents ==========
\section{Introduction}


\subsection{Problem statement of key-distribution}
Key distribution is one of the main issues in cryptography. In a scenario when two parties want to establish secure communication channel, first they need to agree on a shared secret key. This is an issue for symmetric cryptography protocols, where cryptographic key has to be securely shared between sender and receiver. It also becomes unmanageable when frequent key change is required or number of participants in communication increases.

\subsection{Classical solution to the public key distribution}
Public key cryptography allows secure distribution of secret key between parties who don't share initial secret information. Diffieâ€“Hellman key exchange protocol~\cite{diffie1976new} allows two parties to agree on a shared secret key. This protocol is frequently used in systems that also achieve forward secrecy because of its fast key generation.
%TODO details of Diffie-Hellman key exchange
%This protocol guarantees that eavesdropper can't guess or break secret key, because discrete logarithm is a difficult and computationally expensive problem.

% TODO Guarantees of secrecy

%eavesdropping problem
    % maybe move this to quantum solution part?
Classic information theory assumes that communication can be eavesdropped either passively or actively. There is no protection against copying transmitted information. Communicating parties can verify with high degree of confidence that exchanged message was not modified, but they should assume that information could have been copied. 

% TODO Verification and non-repudiation

%TODO maybe we can abbreviate remote coin-flip problem -> RCP and public key-exchange problem -> PKP
\subsection{Problem statement of the remote coin-flip problem}
The `coin-flip by telephone' problem was first described in 1981~\cite{blum1981coin}: two distrusting parties, Alice and Bob, want to play a remote game without a third party where both have an equal win-chance, and where neither can cheat.

\subsubsection{Classical solution to the remote coin-flip problem}
In the same paper, the problem was solved by constructing a one-way function $f$ which is two-to-one, meaning that one can have a pair of inputs $x$ and $y$ that map to the same value $f(x)=f(y)$.
An example of such a function is $f(x) =|1/x|$, because every allowed input $x$ has a counterpart $-x$ that $f$ maps to the same value (except for $0$, which is undefined).
Furthermore, $x$ and $y$ have some distinguishing property, for instance, $x$ is always even and $y$ is always odd. Because of the one-way nature of $f$, Alice can randomly select $x$ but it is computationally impossible for her to also find out the corresponding $y$.

After selecting $x$, Alice sends $f(x)=c_{\text{Alice}}$ to Bob (her \textit{commitment} to $x$), and from $f(x)$ Bob cannot know whether Alice used $x$ or $y$.
\footnote{
    This idea is reminiscent of a zero-knowledge proof~\cite{goldwasser1989knowledge}, where one party proves they posses certain information without revealing to the other side what that information is.
    Alice proofs to Bob she committed to one of two choices without revealing her actual choice.
}
So, Bob can proclaim a guess to Alice with a 50\% chance of getting it right.
Subsequently, Alice can claim victory or defeat and proof her original choice of $x$ by sending $x$ to Bob.
Bob can verify the claim by recognising that $x$ is in fact even, and by computing $f(x)=c_{\text{Alice}}$.
Alice does not possess $y$, so she cannot possibly cheat by sending Bob an odd value that $f$ maps to $c_{\text{Alice}}$.

A benefit to this problem is that if the messages between Alice and Bob are signed, any attempt at cheating on the part of Alice (say she sends $x'$ such that $f(x') \neq c_{\text{Alice}}$) to a judge.

% Need for quantum solutions

\subsection{Need for new solutions}
Many cryptography methods are founded on the assumption that some procedures, such as prime factorisation, are computationally hard, i.e. $P \neq NP$.
A prime example of this is prime factorisation.
However, breakthroughs in algorithm design may yet invalidate this assumption, or, more on topic, the introduction of quantum computing that can execute algorithms such as Shor's algorithm which can do prime factorisation in polynomial time.
In the next section, we will summarise the quantum methods for solving the problems, which rely on fundamental properties of physics for security.

%TODO Add: that Shor breaks DH

\section{Problem solution}
Before presenting the solutions for public-key exchange and remote coin-flipping, we briefly introduce some of the fundamental properties of photons that will be used in both solutions.
%TODO perfect hardware would invalidate the solution, because then the EPR effect would become a problem. we could mention that we assume `good' hardware, but not perfect hardware, because of the EPR effect discussed later on.
% Old sentence:
% All discussion that follows assumes perfect hardware (such as filters, quantum channels, the ability to pick and send individual photons, etc..).

\subsection{The behaviour of polarized photons}
%TODO IMO these two paragraphs explain everything you need to know about quantum mechanics to understand the algorithms, but there's more in-depth math in the paper. Maybe check with the TA that this is enough for section II.
Light exists of individual photon particles, which can be polarised at any angle using polarizing filters.
Four of these polarization axis are important to us: two rectilinear (0 degrees, 90 degrees) and two diagonal (45 degrees, 135 degrees).
To measure the orientation of a polarized photon, one can again use polarizing filters.
If the orientation (or basis) of the filter matches the orientation of the photon, the photon will pass through, and if the filter is orthogonal to the photon, the photon will not pass through.
In other words, rectilinear photons can be measured accurately 100\% of the time (deterministically) if one uses the `correct', rectilinear filter, since the difference in angle between photon and a filter at 0 degrees is always either 0 or 90 degrees.

But suppose the difference is 45 degrees, such as is always the case when you try to measure rectilinear photons with the `wrong', diagonal filter. 
It happens that the probability of photons passing through this filter is exactly 50\%, so the measurement will tell you exactly nothing about the original polarization.
Photons that did pass through now have the same polarization as the filter, so re-measuring them tells you nothing about their original orientation.
Furthermore, we cannot simply clone photons and perform multiple measurements.
Essentially, you only get one chance to measure a photon.


\subsection{Quantum key distribution}

In the quantum key distribution protocols, quantum channel is used to exchange random bits between two parties who haven't initially shared any secret information and then continue conversation using classic communication channel. As soon as both parties share random bits using quantum channel, both parties will be able to verify that quantum key exchange was not disturbed. Using quantum channel compels potential eavesdropper to be active and this will compel eavesdropper to affect shared bits. If they don't detect disturbance, both parties agree to use shared secret bits to encrypt classic communication channel. If they detect that their exchange was disturbed they will try again to securely share enough random bits using a quantum channel to have a guarantee with high probability that their communication is secure.
The protocol for a quantum key exchange is as follows:

Using a quantum channel:
\begin{enumerate}
    \item Alice chooses random bit-string, encodes each bits as polarized photons, switching randomly between rectilinear and diagonal bases and sends polarized photons to Bob.
    \item Bob independent of Alice, randomly chooses what bases to use to measure photons (rectilinear or diagonal polarization).
\end{enumerate}

Using a classic channel (with the assumption that it could be monitored, but those messages can't be changed or altered):

\begin{enumerate}
    \setcounter{enumi}{2}
    \item Bob reveals for each photon what basis he used to measure (rectilinear or diagonal).
    \item Alice reveals which basis were correct.
    \item Alice and Bob use the correct bits to generate a key for use in classic communication channel.
\end{enumerate}

Because photons have to be measured using random choice of rectilinear or diagonal basis, any measurement by an eavesdropper will alter the message Bob gets and subsequently produce disagreement between Alice and Bob on bits that they should agree on.

\subsection{Disadvantages and possible attacks for quantum key distribution}
As mentioned in section 1.1 classic information theory assumes that digital communications can be passively monitored. Quantum information theory guarantees that communication cannot be passively monitored and forces the adversary to be active and detectable. However there are possible attacks.

%TODO (no verification who sent the photon)
%related
One of the easiest attack is that an eavesdropper can try to suppress communications by introducing noise into a channel or just by trying to measure photons. This won't help with secretly obtaining the key but prevents the key exchange altogether.

More sophisticated attacks involve quantum phenomena that have not yet been demonstrated as possible but exist as a theoretical thought experiment. In this case if an adversary can clone or multiply photons he can measure them in multiple bases and choose correct ones after Alice and Bob share correct bases in public channel.

\subsection{The quantum remote coin-flip protocol}
The protocol for a quantum remote coin-flip is as follows:
\begin{enumerate}
	\item
		Alice chooses at random a secret basis (rectilinear or diagonal) and encodes a secret, random bit-string of decent length as polarized photons using her chosen basis.
		She sends over the photons to Bob on a quantum channel.
	\item
		To win, Bob has to guess Alice's choice of basis.
		But when Bob receives the photons, he does not know how to measure them deterministically to find out their polarization.
		The best he can do is switch bases randomly and independently for each photon, so that he at least ends up with a half-filled rectilinear measurement table and a half-filled diagonal measurement table, one of which is 100\% correct and the other is 50\% correct.
		With nothing to go on, Bob has to make a random guess to Alice as to the original basis.
	\item Alice reveals her basis, and sends over the original bit-string on a classical channel.
	\item Bob can verify Alice's choice, because he can confirm that the elements of the bit-string matches up 100\% with the corresponding measurement table.
\end{enumerate}

Like in the classical solution, the key is that one party has to send a commitment to their choice to the other party, without revealing the choice itself.

\section{Benefits and drawbacks of the solution}
%TODO  and other approaches to solve the problem?

\subsection{Advantages of the quantum remote coin-flip protocol}

\subsubsection{Impossibility of cheating}
The protocol is protected against cheating by the laws of physics, instead of by computational hardness:

\begin{itemize}
	\item Given the polarized photons, Bob cannot guess the basis of the polarization with a probability greater than $1/2$.
	\item Alice has to provide the measurement results of the table with the basis she supposedly picked: if she lies about the basis (because Bob guessed it correctly), she would have to guess the contents of the other table.
	If $n$ photons were sent, the probability that she can perfectly match the table is $\frac{1}{(n/2)^2}=\frac{4}{n^2}$.
	%TODO check that this math is correct
	Getting even one measurement wrong would expose Alice as a cheater.
	\item Alice could send a mix of rectilinear and diagonal photons, but then she would not be able to verify either table: so even if Bob loses, she won't be able to claim her win by verifying.	
	%TODO does not totally make sense, Bob cannot win/lose if Alice does not pick a basis
\end{itemize}

\subsection{Disadvantages of the quantum remote coin-flip protocol}

\subsubsection{No non-repudation} Since digital signatures cannot be created with quantum cryptography, Alice or Bob could deny that the coin-flip happened (and the other would not be able to prove to a judge that it did happen).
%TODO source on digital signatures
%TODO or conversely, they could pretend a coin-flip happened when it did not?

\subsubsection{Need for quantum hardware} %TODO probably for general to both
Even though the quantum remote coin-flip has been performed experimentally, there is no prediction for when quantum hardware will become available.
Furthermore, quantum transmissions 
%TODO ref to the french experiment?
%TODO oppertunit to talk about how close quantum computing is
This is also good news, because it means that for now we can still rely on computational hardness to safeguard the classical solution.
More generally, quantum solutions such as these will become useful on the same day that classical solutions will be compromised.

\subsubsection{Possibility of cheating}
In theory, Alice can cheat by using the Einstein-Podolsky-Rosen effect, which implies that pairs of polarized photons can be created which always collapse to opposite directions (regardless of in which basis they are measured).
Alice could encode the bit-string in such pairs, send one photon of each pair to Bob and keep the other.
If Bob then guesses, say, rectilinear, she can measure her photons in the diagonal basis, thus being able to match the results of Bob's diagonal table, pretending to have used diagonal encoding all along and verifying her `win'.

However, storing and measuring the twin photons with 100\% accuracy is likely impossible in practice.

\subsubsection{Generating random bit-strings}
The bit-string that Alice encodes needs to be generated by a cryptographically secure pseudo-random number generator.
In a post-quantum world, a CSPRNG that relies on prime-factorisation (such as a RSA generator) would be compromised, so it obviously should not be used in an implementation of this protocol.
%TODO ref to slides / RSA generator?
Maybe Alice should just measure rectilinear photons diagonally, instead.


\section{Implementation of simulation of the quantum remote coin-flip protocol}
Microsoft's Q\#~\cite{qsharp} project is a quantum development kit for expressing and running simulations of quantum programs on a classical machine.
With this, we implemented a simulation of the quantum remote coin-flip.
The end-product is a simulation in two ways: obviously, no actual qubits were used, and secondly, since Q\# does not provide a way to simulate a quantum channel, the communication between Alice and Bob takes place in one process.

\subsection{From photons to qubits}
Photons are one way to achieve quantum behaviour, but in quantum computing, the implementation (be it photons or otherwise) is abstracted away behind the concept of qubits, which uses linear algebra as foundation.
A qubit is represented as a vector $\vec{q}=\begin{pmatrix} a \\ b\end{pmatrix}$ where $a, b \in \mathbb{C}$ and $\lvert \vec{q} \rvert =1$.
Qubits can be manipulated using linear transformations, such as the negation operation $X$ and the Hadamard gate operation $H$:

\begin{equation}
    X = \begin{pmatrix} 0 & 1 \\ 1 & 0 \\\end{pmatrix} \quad
    H = \begin{pmatrix} \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} \\ \frac{1}{\sqrt{2}} & \frac{-1}{\sqrt{2}} \\\end{pmatrix}
\end{equation}

Since $\vec{q}$ is a (unit) vector, it can be visualised in 3D space in a unit sphere, the so-called Bloch sphere.
For our purposes, we don't need the imaginary axis, so we operate in one slice of this sphere: a unit circle.

\begin{figure}
    \centering
    \includegraphics{}
    \caption{Caption}
    \label{fig:my_label}
\end{figure}

%TODO not sure if I should add a cite to the bloch paper cause i never read it \cite{bloch1946nuclear}

The $a$ and $b$ values determine the superposition or quantum state of the qubit, but we cannot obtain these values directly. Instead, we have to measure $\vec{q}$, and the only possible outcomes are either $0$ or $1$, ie. a classical bit (or cbit).
The result of a measurement is probabilistic, and depends on the value of $a$, $b$ and the type of the measurement.
In Q\#, we use Pauli measurements, which are 2-by-2 linear transformation matrices that always transform a qubit back to .



%TODO add link / ref : https://github.com/hbierlee/quantum-coin-toss

\bibliography{sources}
\bibliographystyle{acm}

\end{document}
